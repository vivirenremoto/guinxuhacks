<!DOCTYPE html>
<html>

<head>
    <title>Gintxu Hacks</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>


</head>

<body>


    <div id="content"></div>



    <audio id="music" loop>
        <source src="static/music.mp3" type="audio/mp3">
    </audio>


    <audio id="sonido_puerta">
        <source src="static/puerta.mp3" type="audio/mp3">
    </audio>

    <script>

        var stages = ['intro', 'scroll', 'water', 'cloud', 'dark', 'height'];

        var music_playing = false;

        var music = document.getElementById('music');
        music.volume = 0.5;


        var sonido_puerta = document.getElementById('sonido_puerta');



        var current_stage = parseInt(window.localStorage.getItem('stage'));



        if (isNaN(current_stage)) {
            current_stage = 0;
        }


        if (document.location.href.indexOf('?test') > -1) {
            current_stage = 0;
        }



        function nextStage() {






            if (current_stage < stages.length) {



                $('#content').html('<iframe id="game" src="' + stages[current_stage] + '.html" style="position:fixed;border:0;width:100%;height:100%;left:0;top:0;"></iframe>');





            } else {
                alert('Â¡ENHORABUENA! HAS COMPLETADO EL JUEGO');


                current_stage = 0;

                location.reload();

            }




            window.localStorage.setItem('stage', current_stage);


        }


        $('body').bind('complete', function () {



            current_stage += 1;
            nextStage();



        });


        $('body').bind('open_door', function () {


            sonido_puerta.play();



        });


        $('body').bind('play_music', function () {



            if (!music_playing) {
                music_playing = true;
                music.play();
            }


        });




        nextStage();

    </script>



</body>

</html>